!function(){angular.module("app",["app.core","app.home","app.item","app.store","lbServices","ui.router","ui.bootstrap","ngCart"]).config(["$urlRouterProvider",function(t){t.otherwise("/")}]).run(["$rootScope","$state","$stateParams",function(t,a,e){t.$state=a,t.$stateParams=e}])}();
!function(){angular.module("app.core",["ui.router","uiRouterStyles"]).config(["$stateProvider",function(t){t.state("tt",{"abstract":!0,templateUrl:"js/core/tt-nav.html",data:{css:"css/app.css"}})}])}();
!function(){function t(){return{restrict:"E",templateUrl:"js/core/tt-nav.html"}}angular.module("app.core").directive("ttNav",[t])}();
!function(){angular.module("app.home",["ui.router","uiRouterStyles"]).config(["$stateProvider",function(t){t.state("home",{url:"^/",templateUrl:"js/home/home.html",data:{css:["http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800","http://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic","theme/font-awesome/css/font-awesome.min.css","theme/css/animate.min.css","theme/css/creative.css"]}})}])}();
!function(){angular.module("app.item",["ui.router","uiRouterStyles"]).config(["$stateProvider",function(t){t.state("tt.item",{"abstract":!0,template:"<ui-view/>"}).state("tt.item.search",{url:"^/items",templateUrl:"js/item/search.html"}).state("tt.item.detail",{url:"^/items/:id",templateUrl:"js/item/detail.html",data:{css:"css/app.css"}}).state("tt.item.entryEdit",{url:"^/items/:itemId/giftEntry/:id",templateUrl:"js/item/upsert.html",data:{css:"css/app.css"}}).state("tt.item.entryAdd",{url:"^/items/:itemId/giftEntry",templateUrl:"js/item/upsert.html",data:{css:"css/app.css"}})}])}();
!function(){function t(t){function e(e){t.findItems(e).then(function(){i.items=t.items})}var i=this;i.items=t.items,i.serialNumber="",i.findItems=e,t.findItems(i.serialNumber).then(function(){i.items=t.items})}function e(t,e){var i=this;i.item=t.item,t.getItem(e.id).then(function(){i.item=t.item})}function i(t,e,i,n){var r=this;r.saveEntry=t.saveGiftEntry,r.item=e.item,r.giftEntry=t.giftEntry,i.id?t.getGiftEntry(i.id).then(function(){r.giftEntry=t.giftEntry}):r.giftEntry=t.createGiftEntry(i.itemId),e.getItem(i.itemId).then(function(){r.item=e.item})}angular.module("app.item").controller("SearchController",["ItemFactory",t]).controller("ItemController",["ItemFactory","$stateParams",e]).controller("GiftEntryController",["GiftEntryFactory","ItemFactory","$stateParams","$state",i])}();
!function(){function t(t,n){return{require:"ngModel",link:function(i,e,r,a){a.$asyncValidators.pin=function(e,r){return t.post("api/giftEntries/check-pin",{giftEntry:{itemId:i.vm.giftEntry.itemId,pin:r}}).then(function(t){return t.data.valid?!0:n.reject(t.data.errorMessage)})}}}}angular.module("app.item").directive("pinValidator",["$http","$q",t])}();
!function(){function t(n){function e(e){return n.findById({id:e,filter:{include:"giftEntries"}}).$promise.then(function(n){n.giftEntries.forEach(function(t){t.date=new Date(t.date)}),t.item=n})}function i(e){return n.find({filter:{include:"giftEntries",where:{serialNumber:{like:e}}}}).$promise.then(function(n){t.items=n})}return t.item={},t.items=[],t.getItem=e,t.findItems=i,t}function n(t,e){function i(e){return t.findById({id:e,filter:{include:"item"}}).$promise.then(function(t){t.date=new Date(t.date),n.giftEntry=t})}function r(t){return n.giftEntry={itemId:t},n.giftEntry}function f(n){t.upsert(n).then(function(t){$state.go("itemDetail",{id:t.itemId})})}return n.giftEntry={},n.getGiftEntry=i,n.createGiftEntry=r,n.saveGiftEntry=f,n}angular.module("app.item").factory("ItemFactory",["Item",t]).factory("GiftEntryFactory",["GiftEntry","$q",n])}();
!function(){angular.module("app.store",["ui.router","uiRouterStyles","ngCart"]).config(["$stateProvider",function(t){t.state("tt.store",{"abstract":!0,template:"<ui-view/>"}).state("tt.store.list",{url:"^/store",templateUrl:"js/store/store.html",data:{css:"css/app.css"}}).state("tt.store.product",{url:"^/store/:id",templateUrl:"js/store/display.html",data:{css:"css/app.css"}}).state("tt.store.cart",{url:"^/cart",templateUrl:"js/store/cart.html",data:{css:"css/app.css"}})}])}();
!function(){function o(o,r){function t(){n.products=o.find()}var n=this;n.products=[],t()}function r(o){}angular.module("app.store").controller("StoreController",["Product","ngCart",o]).controller("ProductController",["Product",r])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvcmUvYXBwLmpzIiwiY29yZS9uYXYuZGlyZWN0aXZlLmpzIiwiaG9tZS9hcHAuanMiLCJpdGVtL2FwcC5qcyIsIml0ZW0vY29udHJvbGxlcnMuanMiLCJpdGVtL3Bpbi12YWxpZGF0b3IuZGlyZWN0aXZlLmpzIiwiaXRlbS9zZXJ2aWNlcy5qcyIsInN0b3JlL2FwcC5qcyIsInN0b3JlL2NvbnRyb2xsZXJzLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJvdGhlcndpc2UiLCJydW4iLCIkcm9vdFNjb3BlIiwiJHN0YXRlIiwiJHN0YXRlUGFyYW1zIiwiJHN0YXRlUHJvdmlkZXIiLCJzdGF0ZSIsImFic3RyYWN0IiwidGVtcGxhdGVVcmwiLCJkYXRhIiwiY3NzIiwidHROYXYiLCJyZXN0cmljdCIsImRpcmVjdGl2ZSIsInVybCIsInRlbXBsYXRlIiwiU2VhcmNoQ29udHJvbGxlciIsIkl0ZW1GYWN0b3J5IiwiZmluZEl0ZW1zIiwic2VyaWFsTnVtYmVyIiwidGhlbiIsInZtIiwiaXRlbXMiLCJ0aGlzIiwiSXRlbUNvbnRyb2xsZXIiLCJpdGVtIiwiZ2V0SXRlbSIsImlkIiwiR2lmdEVudHJ5Q29udHJvbGxlciIsIkdpZnRFbnRyeUZhY3RvcnkiLCJzYXZlRW50cnkiLCJzYXZlR2lmdEVudHJ5IiwiZ2lmdEVudHJ5IiwiZ2V0R2lmdEVudHJ5IiwiY3JlYXRlR2lmdEVudHJ5IiwiaXRlbUlkIiwiY29udHJvbGxlciIsInBpblZhbGlkYXRvciIsIiRodHRwIiwiJHEiLCJyZXF1aXJlIiwibGluayIsInNjb3BlIiwiZWxlbWVudCIsImF0dHJzIiwibmdNb2RlbCIsIiRhc3luY1ZhbGlkYXRvcnMiLCJwaW4iLCJtb2RlbFZhbHVlIiwidmlld1ZhbHVlIiwicG9zdCIsInJlc3BvbnNlIiwidmFsaWQiLCJyZWplY3QiLCJlcnJvck1lc3NhZ2UiLCJJdGVtIiwiZmluZEJ5SWQiLCJmaWx0ZXIiLCJpbmNsdWRlIiwiJHByb21pc2UiLCJnaWZ0RW50cmllcyIsImZvckVhY2giLCJlbnRyeSIsImRhdGUiLCJEYXRlIiwiZmluZCIsIndoZXJlIiwibGlrZSIsIkdpZnRFbnRyeSIsInVwc2VydCIsImdvIiwiZmFjdG9yeSIsIlN0b3JlQ29udHJvbGxlciIsIlByb2R1Y3QiLCJuZ0NhcnQiLCJnZXRQcm9kdWN0cyIsInByb2R1Y3RzIiwiUHJvZHVjdENvbnRyb2xsZXIiXSwibWFwcGluZ3MiOiJDQUFBLFdBQ0VBLFFBQVFDLE9BQU8sT0FDYixXQUNBLFdBQ0EsV0FDQSxZQUNBLGFBQ0EsWUFDQSxlQUNBLFdBRUNDLFFBQVEscUJBQXNCLFNBQVVDLEdBQ3ZDQSxFQUFtQkMsVUFBVSxRQUU5QkMsS0FBSyxhQUFjLFNBQVUsZUFBZ0IsU0FBVUMsRUFBWUMsRUFBUUMsR0FDeEVGLEVBQVdDLE9BQVNBLEVBQ3BCRCxFQUFXRSxhQUFlQTtDQ2hCbEMsV0FDRVIsUUFBUUMsT0FBTyxZQUFhLFlBQWEsbUJBQ3RDQyxRQUFRLGlCQUFrQixTQUFVTyxHQUNuQ0EsRUFDR0MsTUFBTSxNQUNMQyxZQUFVLEVBQ1ZDLFlBQWEsc0JBQ2JDLE1BQU9DLElBQUs7Q0NQdEIsV0FJRSxRQUFTQyxLQUNQLE9BQ0VDLFNBQVUsSUFDVkosWUFBYSx1QkFOakJaLFFBQVFDLE9BQU8sWUFDWmdCLFVBQVUsU0FBVUY7Q0NGekIsV0FDRWYsUUFBUUMsT0FBTyxZQUFhLFlBQWEsbUJBQ3RDQyxRQUFRLGlCQUFrQixTQUFVTyxHQUNuQ0EsRUFDR0MsTUFBTSxRQUNMUSxJQUFLLEtBQ0xOLFlBQWEsb0JBQ2JDLE1BQ0VDLEtBQ0UseUhBQ0EsOEdBQ0EsOENBQ0EsNEJBQ0E7Q0NiZCxXQUNFZCxRQUFRQyxPQUFPLFlBQWEsWUFBYSxtQkFDdENDLFFBQVEsaUJBQWtCLFNBQVVPLEdBQ25DQSxFQUNHQyxNQUFNLFdBQ0xDLFlBQVUsRUFDVlEsU0FBVSxlQUVYVCxNQUFNLGtCQUNMUSxJQUFLLFVBQ0xOLFlBQWEsd0JBRWRGLE1BQU0s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dCI6WyIoZnVuY3Rpb24gKCkge1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuICAgICdhcHAuY29yZScsXG4gICAgJ2FwcC5ob21lJyxcbiAgICAnYXBwLml0ZW0nLFxuICAgICdhcHAuc3RvcmUnLFxuICAgICdsYlNlcnZpY2VzJyxcbiAgICAndWkucm91dGVyJyxcbiAgICAndWkuYm9vdHN0cmFwJyxcbiAgICAnbmdDYXJ0J1xuICBdKVxuICAgIC5jb25maWcoWyckdXJsUm91dGVyUHJvdmlkZXInLCBmdW5jdGlvbiAoJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG4gICAgfV0pXG4gICAgLnJ1bihbJyRyb290U2NvcGUnLCAnJHN0YXRlJywgJyRzdGF0ZVBhcmFtcycsIGZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkc3RhdGUsICRzdGF0ZVBhcmFtcykge1xuICAgICAgICAkcm9vdFNjb3BlLiRzdGF0ZSA9ICRzdGF0ZTtcbiAgICAgICAgJHJvb3RTY29wZS4kc3RhdGVQYXJhbXMgPSAkc3RhdGVQYXJhbXM7XG4gICAgfV0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAuY29yZScsIFsndWkucm91dGVyJywgJ3VpUm91dGVyU3R5bGVzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAuc3RhdGUoJ3R0Jywge1xuICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvY29yZS90dC1uYXYuaHRtbCcsXG4gICAgICAgICAgZGF0YToge2NzczogJ2Nzcy9hcHAuY3NzJ31cbiAgICAgICAgfSk7XG4gICAgfV0pO1xufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAuY29yZScpXG4gICAgLmRpcmVjdGl2ZSgndHROYXYnLCBbdHROYXZdKTtcblxuICBmdW5jdGlvbiB0dE5hdiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICB0ZW1wbGF0ZVVybDogJ2pzL2NvcmUvdHQtbmF2Lmh0bWwnXG4gICAgfTtcbiAgfVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAuaG9tZScsIFsndWkucm91dGVyJywgJ3VpUm91dGVyU3R5bGVzJ10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAuc3RhdGUoJ2hvbWUnLCB7XG4gICAgICAgICAgdXJsOiAnXi8nLFxuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvaG9tZS9ob21lLmh0bWwnLFxuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGNzczogW1xuICAgICAgICAgICAgICAnaHR0cDovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2Nzcz9mYW1pbHk9T3BlbitTYW5zOjMwMGl0YWxpYyw0MDBpdGFsaWMsNjAwaXRhbGljLDcwMGl0YWxpYyw4MDBpdGFsaWMsNDAwLDMwMCw2MDAsNzAwLDgwMCcsXG4gICAgICAgICAgICAgICdodHRwOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzP2ZhbWlseT1NZXJyaXdlYXRoZXI6NDAwLDMwMCwzMDBpdGFsaWMsNDAwaXRhbGljLDcwMCw3MDBpdGFsaWMsOTAwLDkwMGl0YWxpYycsXG4gICAgICAgICAgICAgICd0aGVtZS9mb250LWF3ZXNvbWUvY3NzL2ZvbnQtYXdlc29tZS5taW4uY3NzJyxcbiAgICAgICAgICAgICAgJ3RoZW1lL2Nzcy9hbmltYXRlLm1pbi5jc3MnLFxuICAgICAgICAgICAgICAndGhlbWUvY3NzL2NyZWF0aXZlLmNzcydcbiAgICAgICAgICAgIF1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwLml0ZW0nLCBbJ3VpLnJvdXRlcicsICd1aVJvdXRlclN0eWxlcyddKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlcikge1xuICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgLnN0YXRlKCd0dC5pdGVtJywge1xuICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgIHRlbXBsYXRlOiAnPHVpLXZpZXcvPidcbiAgICAgICAgfSlcbiAgICAgICAgLnN0YXRlKCd0dC5pdGVtLnNlYXJjaCcsIHtcbiAgICAgICAgICB1cmw6ICdeL2l0ZW1zJyxcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2pzL2l0ZW0vc2VhcmNoLmh0bWwnXG4gICAgICAgIH0pXG4gICAgICAgIC5zdGF0ZSgndHQuaXRlbS5kZXRhaWwnLCB7XG4gICAgICAgICAgdXJsOiAnXi9pdGVtcy86aWQnLFxuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvaXRlbS9kZXRhaWwuaHRtbCcsXG4gICAgICAgICAgZGF0YToge2NzczogJ2Nzcy9hcHAuY3NzJ31cbiAgICAgICAgfSlcbiAgICAgICAgLnN0YXRlKCd0dC5pdGVtLmVudHJ5RWRpdCcsIHtcbiAgICAgICAgICB1cmw6ICdeL2l0ZW1zLzppdGVtSWQvZ2lmdEVudHJ5LzppZCcsXG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9pdGVtL3Vwc2VydC5odG1sJyxcbiAgICAgICAgICBkYXRhOiB7Y3NzOiAnY3NzL2FwcC5jc3MnfVxuICAgICAgICB9KVxuICAgICAgICAuc3RhdGUoJ3R0Lml0ZW0uZW50cnlBZGQnLCB7XG4gICAgICAgICAgdXJsOiAnXi9pdGVtcy86aXRlbUlkL2dpZnRFbnRyeScsXG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9pdGVtL3Vwc2VydC5odG1sJyxcbiAgICAgICAgICBkYXRhOiB7Y3NzOiAnY3NzL2FwcC5jc3MnfVxuICAgICAgICB9KTtcbiAgICB9XSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5pdGVtJylcbiAgICAuY29udHJvbGxlcignU2VhcmNoQ29udHJvbGxlcicsIFsnSXRlbUZhY3RvcnknLCBTZWFyY2hDb250cm9sbGVyXSlcbiAgICAuY29udHJvbGxlcignSXRlbUNvbnRyb2xsZXInLCBbJ0l0ZW1GYWN0b3J5JywgJyRzdGF0ZVBhcmFtcycsIEl0ZW1Db250cm9sbGVyXSlcbiAgICAuY29udHJvbGxlcignR2lmdEVudHJ5Q29udHJvbGxlcicsIFsnR2lmdEVudHJ5RmFjdG9yeScsICdJdGVtRmFjdG9yeScsICckc3RhdGVQYXJhbXMnLCAnJHN0YXRlJywgR2lmdEVudHJ5Q29udHJvbGxlcl0pO1xuXG4gIGZ1bmN0aW9uIFNlYXJjaENvbnRyb2xsZXIgKEl0ZW1GYWN0b3J5KSB7XG4gICAgdmFyIHZtID0gdGhpcztcbiAgICB2bS5pdGVtcyA9IEl0ZW1GYWN0b3J5Lml0ZW1zO1xuICAgIHZtLnNlcmlhbE51bWJlciA9ICcnO1xuICAgIHZtLmZpbmRJdGVtcyA9IGZpbmRJdGVtcztcblxuICAgIEl0ZW1GYWN0b3J5LmZpbmRJdGVtcyh2bS5zZXJpYWxOdW1iZXIpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgdm0uaXRlbXMgPSBJdGVtRmFjdG9yeS5pdGVtcztcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIGZpbmRJdGVtcyAoc2VyaWFsTnVtYmVyKSB7XG4gICAgICBJdGVtRmFjdG9yeS5maW5kSXRlbXMoc2VyaWFsTnVtYmVyKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdm0uaXRlbXMgPSBJdGVtRmFjdG9yeS5pdGVtcztcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIEl0ZW1Db250cm9sbGVyIChJdGVtRmFjdG9yeSwgJHN0YXRlUGFyYW1zKSB7XG4gICAgdmFyIHZtID0gdGhpcztcblxuICAgIHZtLml0ZW0gPSBJdGVtRmFjdG9yeS5pdGVtO1xuXG4gICAgSXRlbUZhY3RvcnkuZ2V0SXRlbSgkc3RhdGVQYXJhbXMuaWQpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgdm0uaXRlbSA9IEl0ZW1GYWN0b3J5Lml0ZW07XG4gICAgfSk7XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIEdpZnRFbnRyeUNvbnRyb2xsZXIgKEdpZnRFbnRyeUZhY3RvcnksIEl0ZW1GYWN0b3J5LCAkc3RhdGVQYXJhbXMsICRzdGF0ZSkge1xuICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICB2bS5zYXZlRW50cnkgPSBHaWZ0RW50cnlGYWN0b3J5LnNhdmVHaWZ0RW50cnk7XG4gICAgdm0uaXRlbSA9IEl0ZW1GYWN0b3J5Lml0ZW07XG4gICAgdm0uZ2lmdEVudHJ5ID0gR2lmdEVudHJ5RmFjdG9yeS5naWZ0RW50cnk7XG5cbiAgICBpZiAoJHN0YXRlUGFyYW1zLmlkKSB7XG4gICAgICBHaWZ0RW50cnlGYWN0b3J5LmdldEdpZnRFbnRyeSgkc3RhdGVQYXJhbXMuaWQpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICB2bS5naWZ0RW50cnkgPSBHaWZ0RW50cnlGYWN0b3J5LmdpZnRFbnRyeTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB2bS5naWZ0RW50cnkgPSBHaWZ0RW50cnlGYWN0b3J5LmNyZWF0ZUdpZnRFbnRyeSgkc3RhdGVQYXJhbXMuaXRlbUlkKTtcbiAgICB9XG5cbiAgICBJdGVtRmFjdG9yeS5nZXRJdGVtKCRzdGF0ZVBhcmFtcy5pdGVtSWQpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgdm0uaXRlbSA9IEl0ZW1GYWN0b3J5Lml0ZW07XG4gICAgfSk7XG4gIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwLml0ZW0nKVxuICAgIC5kaXJlY3RpdmUoJ3BpblZhbGlkYXRvcicsIFsnJGh0dHAnLCAnJHEnLCBwaW5WYWxpZGF0b3JdKTtcblxuICBmdW5jdGlvbiBwaW5WYWxpZGF0b3IgKCRodHRwLCAkcSkge1xuICAgIHJldHVybiB7XG4gICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXG4gICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBuZ01vZGVsKSB7XG4gICAgICAgIG5nTW9kZWwuJGFzeW5jVmFsaWRhdG9ycy5waW4gPSBmdW5jdGlvbiAobW9kZWxWYWx1ZSwgdmlld1ZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJ2FwaS9naWZ0RW50cmllcy9jaGVjay1waW4nLCB7Z2lmdEVudHJ5OiB7aXRlbUlkOiBzY29wZS52bS5naWZ0RW50cnkuaXRlbUlkLCBwaW46IHZpZXdWYWx1ZX19KVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgIGlmICghcmVzcG9uc2UuZGF0YS52YWxpZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UuZGF0YS5lcnJvck1lc3NhZ2UpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwLml0ZW0nKVxuICAgIC5mYWN0b3J5KCdJdGVtRmFjdG9yeScsIFsnSXRlbScsIEl0ZW1GYWN0b3J5XSlcbiAgICAuZmFjdG9yeSgnR2lmdEVudHJ5RmFjdG9yeScsIFsnR2lmdEVudHJ5JywgJyRxJywgR2lmdEVudHJ5RmFjdG9yeV0pO1xuXG4gIGZ1bmN0aW9uIEl0ZW1GYWN0b3J5IChJdGVtKSB7XG5cbiAgICBJdGVtRmFjdG9yeS5pdGVtID0ge307XG4gICAgSXRlbUZhY3RvcnkuaXRlbXMgPSBbXTtcbiAgICBJdGVtRmFjdG9yeS5nZXRJdGVtID0gZ2V0SXRlbTtcbiAgICBJdGVtRmFjdG9yeS5maW5kSXRlbXMgPSBmaW5kSXRlbXM7XG5cbiAgICByZXR1cm4gSXRlbUZhY3Rvcnk7XG5cbiAgICBmdW5jdGlvbiBnZXRJdGVtIChpZCkge1xuICAgICAgcmV0dXJuIEl0ZW0uZmluZEJ5SWQoe2lkOiBpZCwgZmlsdGVyOiB7aW5jbHVkZTogJ2dpZnRFbnRyaWVzJ319KS4kcHJvbWlzZS50aGVuKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIGl0ZW0uZ2lmdEVudHJpZXMuZm9yRWFjaChmdW5jdGlvbiAoZW50cnkpIHtcbiAgICAgICAgICBlbnRyeS5kYXRlID0gbmV3IERhdGUoZW50cnkuZGF0ZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBJdGVtRmFjdG9yeS5pdGVtID0gaXRlbTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZpbmRJdGVtcyAoc2VyaWFsTnVtYmVyKSB7XG4gICAgICByZXR1cm4gSXRlbS5maW5kKHtmaWx0ZXI6IHtpbmNsdWRlOiAnZ2lmdEVudHJpZXMnLCB3aGVyZToge3NlcmlhbE51bWJlcjoge2xpa2U6IHNlcmlhbE51bWJlcn19fX0pXG4gICAgICAgIC4kcHJvbWlzZS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgSXRlbUZhY3RvcnkuaXRlbXMgPSBkYXRhO1xuICAgICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBHaWZ0RW50cnlGYWN0b3J5IChHaWZ0RW50cnksICRxKSB7XG4gICAgR2lmdEVudHJ5RmFjdG9yeS5naWZ0RW50cnkgPSB7fTtcbiAgICBHaWZ0RW50cnlGYWN0b3J5LmdldEdpZnRFbnRyeSA9IGdldEdpZnRFbnRyeTtcbiAgICBHaWZ0RW50cnlGYWN0b3J5LmNyZWF0ZUdpZnRFbnRyeSA9IGNyZWF0ZUdpZnRFbnRyeTtcbiAgICBHaWZ0RW50cnlGYWN0b3J5LnNhdmVHaWZ0RW50cnkgPSBzYXZlR2lmdEVudHJ5O1xuXG4gICAgcmV0dXJuIEdpZnRFbnRyeUZhY3Rvcnk7XG5cbiAgICBmdW5jdGlvbiBnZXRHaWZ0RW50cnkgKGlkKSB7XG4gICAgICByZXR1cm4gR2lmdEVudHJ5LmZpbmRCeUlkKHtpZDogaWQsIGZpbHRlcjoge2luY2x1ZGU6ICdpdGVtJ319KS4kcHJvbWlzZS50aGVuKGZ1bmN0aW9uIChlbnRyeSkge1xuICAgICAgICBlbnRyeS5kYXRlID0gbmV3IERhdGUoZW50cnkuZGF0ZSk7XG4gICAgICAgIEdpZnRFbnRyeUZhY3RvcnkuZ2lmdEVudHJ5ID0gZW50cnk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVHaWZ0RW50cnkgKGl0ZW1JZCkge1xuICAgICAgR2lmdEVudHJ5RmFjdG9yeS5naWZ0RW50cnkgPSB7aXRlbUlkOiBpdGVtSWR9O1xuICAgICAgcmV0dXJuIEdpZnRFbnRyeUZhY3RvcnkuZ2lmdEVudHJ5O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNhdmVHaWZ0RW50cnkgKGVudHJ5KSB7XG4gICAgICBHaWZ0RW50cnkudXBzZXJ0KGVudHJ5KS50aGVuKGZ1bmN0aW9uIChnaWZ0RW50cnkpIHtcbiAgICAgICAgJHN0YXRlLmdvKCdpdGVtRGV0YWlsJywge2lkOiBnaWZ0RW50cnkuaXRlbUlkfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwLnN0b3JlJywgWyd1aS5yb3V0ZXInLCAndWlSb3V0ZXJTdHlsZXMnLCAnbmdDYXJ0J10pXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAuc3RhdGUoJ3R0LnN0b3JlJywge1xuICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgIHRlbXBsYXRlOiAnPHVpLXZpZXcvPidcbiAgICAgICAgfSlcbiAgICAgICAgLnN0YXRlKCd0dC5zdG9yZS5saXN0Jywge1xuICAgICAgICAgIHVybDogJ14vc3RvcmUnLFxuICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvc3RvcmUvc3RvcmUuaHRtbCcsXG4gICAgICAgICAgZGF0YToge2NzczogJ2Nzcy9hcHAuY3NzJ31cbiAgICAgICAgfSlcbiAgICAgICAgLnN0YXRlKCd0dC5zdG9yZS5wcm9kdWN0Jywge1xuICAgICAgICAgIHVybDogJ14vc3RvcmUvOmlkJyxcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2pzL3N0b3JlL2Rpc3BsYXkuaHRtbCcsXG4gICAgICAgICAgZGF0YToge2NzczogJ2Nzcy9hcHAuY3NzJ31cbiAgICAgICAgfSlcbiAgICAgICAgLnN0YXRlKCd0dC5zdG9yZS5jYXJ0Jywge1xuICAgICAgICAgIHVybDogJ14vY2FydCcsXG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9zdG9yZS9jYXJ0Lmh0bWwnLFxuICAgICAgICAgIGRhdGE6IHtjc3M6ICdjc3MvYXBwLmNzcyd9XG4gICAgICAgIH0pO1xuICAgIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICBhbmd1bGFyLm1vZHVsZSgnYXBwLnN0b3JlJylcbiAgICAuY29udHJvbGxlcignU3RvcmVDb250cm9sbGVyJywgWydQcm9kdWN0JywgJ25nQ2FydCcsIFN0b3JlQ29udHJvbGxlcl0pXG4gICAgLmNvbnRyb2xsZXIoJ1Byb2R1Y3RDb250cm9sbGVyJywgWydQcm9kdWN0JywgUHJvZHVjdENvbnRyb2xsZXJdKTtcblxuICAgIGZ1bmN0aW9uIFN0b3JlQ29udHJvbGxlciAoUHJvZHVjdCwgbmdDYXJ0KSB7XG4gICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICB2bS5wcm9kdWN0cyA9IFtdO1xuXG4gICAgICBnZXRQcm9kdWN0cygpO1xuXG4gICAgICBmdW5jdGlvbiBnZXRQcm9kdWN0cyAoKSB7XG4gICAgICAgIHZtLnByb2R1Y3RzID0gUHJvZHVjdC5maW5kKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gUHJvZHVjdENvbnRyb2xsZXIgKFByb2R1Y3QpIHtcbiAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgfVxufSkoKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
